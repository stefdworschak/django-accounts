
<script>
let channel_closed_unexpectedly = 0;

function setChannels(url){
    const webSocket = new WebSocket(url);

    webSocket.onmessage = function(e) {
        const data = JSON.parse(e.data);
        console.log('Notification Received');
        console.log(data);
    };

    webSocket.onclose = function(e) {
        console.error('Web socket closed unexpectedly');
        if(channel_closed_unexpectedly < 6){
            channel_closed_unexpectedly++;
            console.log("Number of times occurred: "+ channel_closed_unexpectedly);
            setTimeout(function(){
                setChannels(url);
            }, 2000)            
        }
    };

    webSocket.onopen = function(e) {
        console.log('Web socket opened successfully.');
    };
    return webSocket;
}

const connection_uri = `ws://localhost:8000/ws/notifications/group1/`; 
setChannels(connection_uri);
</script>